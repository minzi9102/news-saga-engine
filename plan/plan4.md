基于您当前的架构（ETL管道 + 智能路由 + 全量归档）以及“在 GitHub 上测试几天”的目标，我不需要更多代码信息即可为您制定计划。

目前的系统已经具备了**“生成”**和**“追加”**故事线的能力，但确实缺少**“整理”**（即合并/去重/关闭）的能力。在 GitHub Actions 这种无人工干预的环境下，最容易出现的问题是**“Saga 碎片化”**（同一个事件因为 LLM 措辞不同被拆成了两个故事）。

针对您的需求，我为您设计了三个层进式的方案，建议按顺序或并行考虑：

---

### 方案 A：数据审计与观测 (The Observer)

**目标**：在不修改核心逻辑的前提下，利用这几天的运行数据，**定量评估**“是否需要合并功能”。
**核心思想**：不要急着写合并代码，先看“碎片化”严不严重。

* **执行动作**：
1. **保持现状运行 3-7 天**：让 GitHub Actions 积累数据。
2. **编写 `audit.py` (审计脚本)**：
* 每天读取 `data/sagas/*.json`。
* 计算“相似度矩阵”：使用简单的 TF-IDF 或 Jaccard 相似度，对比所有 Active Saga 的 `title` 和 `context_summary`。
* **输出报告**：如果发现有 Sagas 相似度 > 0.75（例如“巴以冲突升级”和“加沙地带局势”），则标记为“疑似重复”。


3. **人工验收**：几天后，查看 README。如果发现 3 个不同的 Saga 其实在讲同一件事，说明“合并功能”是刚需。


* **优点**：零风险，不影响现有生产环境。
* **缺点**：不能解决问题，只能发现问题。

---

### 方案 B：引入“园丁”机制 (The Gardener) —— **推荐**

**目标**：实现您想要的“Saga 合并”，但**不干扰**每日的主流程（Crawler/Manager）。
**核心思想**：将“合并”作为一个**独立、低频**的维护任务（Weekly/Monthly Job），而不是每次爬虫都运行。像园丁修剪枝叶一样。

* **架构设计**：
* 新增 `src/gardener.py`。
* **Merge Logic (合并逻辑)**：
1. 遍历所有 `Active` 状态的 Saga。
2. 利用 LLM (API) 进行成对评估：“这两个故事线（标题A, 摘要A）与（标题B, 摘要B）是同一个事件吗？如果是，请合并它们的 Events 并重写摘要。”
3. **动作**：将 Saga B 的 `events` 迁移到 Saga A，更新 Saga A 的摘要，将 Saga B 标记为 `ARCHIVED` (merged)。


* **GitHub Actions 配置**：
* 新建一个 Workflow，**每周日**运行一次。




* **优点**：
* **解耦**：爬虫挂了不影响合并，合并挂了不影响爬虫。
* **省钱**：不需要每天都对比，每周整理一次即可。
* **安全**：避免了在每日高频更新中出现数据竞争或逻辑错误。



---

### 方案 C：增强“前台”体验 (The Showcase)

**目标**：提升“故事跟踪”的可视化效果，方便您在 GitHub 上直接评估数据质量。
**核心思想**：README 列表太长了，利用 GitHub Pages 做一个简单的静态时间轴。

* **执行动作**：
1. 修改 `src/reporter.py`，除了生成 README.md，额外生成一个 `index.html`。
2. 利用简单的 HTML/JS (如 Mermaid.js 或 Timeline.js)，将 `data/sagas/*.json` 渲染成可视化的时间轴。
3. 在 GitHub Settings 中开启 Pages，指向 `docs/` 或根目录。


* **优点**：一目了然地看到时间线的**连贯性**。如果一个时间轴断断续续，或者两个时间轴长得一样，一眼就能看出需要“合并”。

---

### 💡 技术负责人的建议

**目前的优先级建议：**

1. **Step 1 (当前)**: 维持现状，在 GitHub 上跑 3 天。
* *关注点*：观察 `README.md`，看 LLM 是否会因为新闻标题的微小变化（如“俄乌局势” vs “乌克兰危机”）而重复创建 Saga。


2. **Step 2 (3天后)**: 如果你发现确实存在重复（大概率会），不要直接改 `Manager`，而是采用 **方案 B (园丁模式)**。
* *理由*：合并逻辑非常复杂（元数据怎么合？时间线怎么排？），把它从每日的高频任务中剥离出来是最稳健的架构。



**您希望我先为您准备“方案 A”的审计脚本，以便这几天收集数据？还是直接规划“方案 B”的园丁架构？**

---

当前遇到的问题：
1、基于github，需要翻墙，不方便使用
2、生成的报告没有按时间先后排序，新的故事可能放在了旧故事的后面
3、生成的故事中新的消息放在了旧消息的下面
4、生成的故事的总结描述没有总结整个故事或包含最新消息